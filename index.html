<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Secret Message with Bouncing Emoji Background</title>
<style>
  :root {
    --bg-light: #f0f4f8;
    --bg-dark: #121212;
    --color-light: #333;
    --color-dark: #eee;
    --primary-light: #3498db;
    --primary-dark: #2980b9;
  }
  html, body {
    margin: 0; padding: 0;
    height: 100%;
    overflow: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-light);
    color: var(--color-light);
    transition: background-color 0.3s, color 0.3s;
  }
  body.dark {
    background: var(--bg-dark);
    color: var(--color-dark);
  }
  #emoji-background {
    position: fixed;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    pointer-events: none;
    overflow: hidden;
    z-index: 1;
    background: transparent;
  }
  .emoji-ball {
    position: absolute;
    font-size: 28px;
    user-select: none;
    will-change: transform, left, top;
  }
  .container {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 10;
    background: white;
    max-width: 520px;
    width: 90vw;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    text-align: center;
    transition: background-color 0.3s, color 0.3s;
  }
  body.dark .container {
    background: #1e1e1e;
    color: var(--color-dark);
    box-shadow: 0 10px 20px rgba(255,255,255,0.1);
  }
  h2 {
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin: 12px 0 6px;
    font-weight: 600;
    text-align: left;
  }
  textarea, input[type="password"] {
    width: 100%;
    padding: 10px 12px;
    font-size: 1rem;
    border-radius: 8px;
    border: 1.5px solid #ccc;
    box-sizing: border-box;
    transition: border-color 0.3s ease, background-color 0.3s ease, color 0.3s ease;
  }
  body.dark textarea, body.dark input[type="password"] {
    background: #333;
    color: var(--color-dark);
    border-color: #555;
  }
  textarea {
    resize: vertical;
    min-height: 80px;
  }
  textarea:focus, input[type="password"]:focus {
    border-color: var(--primary-light);
    outline: none;
  }
  button {
    background-color: var(--primary-light);
    border: none;
    color: white;
    padding: 12px 25px;
    margin: 10px 8px 20px 8px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.3s ease;
    user-select: none;
  }
  button:hover {
    background-color: var(--primary-dark);
  }
  #output {
    background-color: #ecf0f1;
    border-radius: 8px;
    padding: 15px;
    min-height: 80px;
    font-size: 1.3rem;
    white-space: pre-wrap;
    word-wrap: break-word;
    color: #2c3e50;
    user-select: all;
    margin-top: 10px;
  }
  body.dark #output {
    background-color: #2c2c2c;
    color: var(--color-dark);
  }
  .footer {
    margin-top: 30px;
    font-size: 0.9rem;
    color: #555;
    user-select: none;
  }
  body.dark .footer {
    color: #aaa;
  }
  .theme-toggle {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: var(--primary-light);
    color: white;
    padding: 8px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    user-select: none;
    transition: background-color 0.3s ease;
    z-index: 1000;
  }
  .theme-toggle:hover {
    background-color: var(--primary-dark);
  }
</style>
</head>
<body>
  <div id="emoji-background"></div>

  <div class="theme-toggle" id="themeToggle" tabindex="0" role="button" aria-pressed="false" aria-label="Toggle Light/Dark Theme">üåô Dark Mode</div>

  <div class="container" role="main" aria-label="Secret message encryptor with emoji output">
    <h2>Secret Message</h2>

    <label for="message">Message (type or paste here):</label>
    <textarea id="message" placeholder="Type your message here..."></textarea>

    <label for="password">Password:</label>
    <input type="password" id="password" placeholder="Enter password" />

    <div>
      <button id="encryptBtn">Encrypt üîí</button>
      <button id="decryptBtn">Decrypt üîì</button>
      <button id="copyBtn">Copy Output üìã</button>
    </div>

    <div id="output" aria-live="polite" role="region" tabindex="0"></div>

    <div class="footer">Crafted with ‚ù§Ô∏è by Gopinath</div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  <script>
    const emojiSet = [
      "üòÄ","üòÅ","üòÇ","ü§£","üòÉ","üòÑ","üòÖ","üòÜ",
      "üòâ","üòä","üòã","üòé","üòç","üòò","üòó","üòô",
      "üòö","üôÇ","ü§ó","ü§î","üòê","üòë","üò∂","üôÑ",
      "üòè","üò£","üò•","üòÆ","ü§ê","üòØ","üò™","üò´",
      "üò¥","üòå","üòõ","üòú","üòù","ü§§","üòí","üòì",
      "üòî","üòï","üôÉ","ü§ë","üò≤","‚òπÔ∏è","üôÅ","üòñ",
      "üòû","üòü","üò§","üò¢","üò≠","üò¶","üòß","üò®",
      "üò©","ü§Ø","üò¨","üò∞","üò±","ü•µ","ü•∂","üò≥"
    ];

    const base64Chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";

    function base64ToEmoji(base64Str) {
      let result = "";
      for (let ch of base64Str) {
        if (ch === "=") continue;
        const idx = base64Chars.indexOf(ch);
        if (idx === -1) continue;
        result += emojiSet[idx];
      }
      return result;
    }

    function emojiToBase64(emojiStr) {
      let result = "";
      for (let ch of emojiStr) {
        const idx = emojiSet.indexOf(ch);
        if (idx === -1) continue;
        result += base64Chars.charAt(idx);
      }
      while (result.length % 4 !== 0) result += "=";
      return result;
    }

    function encryptMessage() {
      const msg = document.getElementById('message').value;
      const pwd = document.getElementById('password').value;
      const output = document.getElementById('output');

      if (!msg) {
        alert('Please enter a message.');
        return;
      }
      if (!pwd) {
        alert('Please enter a password.');
        return;
      }

      try {
        const encrypted = CryptoJS.AES.encrypt(msg, pwd).toString();
        const emojiEncoded = base64ToEmoji(encrypted);
        output.textContent = emojiEncoded;
      } catch {
        alert('Encryption failed.');
        output.textContent = "";
      }
    }

    function decryptMessage() {
      const emojiEncrypted = document.getElementById('message').value;
      const pwd = document.getElementById('password').value;
      const output = document.getElementById('output');

      if (!emojiEncrypted) {
        alert('Please enter the encrypted emoji message.');
        return;
      }
      if (!pwd) {
        alert('Please enter a password.');
        return;
      }

      try {
        const base64Str = emojiToBase64(emojiEncrypted);
        const bytes = CryptoJS.AES.decrypt(base64Str, pwd);
        const decrypted = bytes.toString(CryptoJS.enc.Utf8);
        if (!decrypted) {
          alert('Incorrect password or corrupted message.');
          output.textContent = "";
        } else {
          output.textContent = decrypted;
        }
      } catch {
        alert('Decryption failed.');
        output.textContent = "";
      }
    }

    document.getElementById('encryptBtn').addEventListener('click', encryptMessage);
    document.getElementById('decryptBtn').addEventListener('click', decryptMessage);
    document.getElementById('copyBtn').addEventListener('click', () => {
      const outputEl = document.getElementById('output');
      if (!outputEl.textContent) return alert('Nothing to copy!');
      navigator.clipboard.writeText(outputEl.textContent)
        .then(() => alert('Output copied to clipboard!'))
        .catch(() => alert('Clipboard copy failed'));
    });

    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      const isDark = document.body.classList.contains('dark');
      themeToggle.setAttribute('aria-pressed', isDark);
      themeToggle.textContent = isDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
    });

    // Emoji ball bouncing background animation
    const emojiBgContainer = document.getElementById('emoji-background');
    const emojiBallsCount = 30;
    const emojiBalls = [];

    function randomBetween(min, max) {
      return Math.random() * (max - min) + min;
    }

    function createEmojiBall() {
      const span = document.createElement('span');
      span.classList.add('emoji-ball');
      span.textContent = emojiSet[Math.floor(randomBetween(0, emojiSet.length))];
      emojiBgContainer.appendChild(span);

      return {
        el: span,
        x: randomBetween(0, window.innerWidth - 30),
        y: randomBetween(0, window.innerHeight - 30),
        vx: randomBetween(-1.5, 1.5),
        vy: randomBetween(-1.5, 1.5),
        size: randomBetween(22, 32)
      };
    }

    for (let i = 0; i < emojiBallsCount; i++) {
      emojiBalls.push(createEmojiBall());
    }

    function animate() {
      emojiBalls.forEach(ball => {
        ball.x += ball.vx;
        ball.y += ball.vy;

        // Bounce on edges
        if (ball.x <= 0 || ball.x >= window.innerWidth - ball.size) ball.vx *= -1;
        if (ball.y <= 0 || ball.y >= window.innerHeight - ball.size) ball.vy *= -1;

        ball.el.style.left = ball.x + 'px';
        ball.el.style.top = ball.y + 'px';
        ball.el.style.fontSize = ball.size + 'px';
      });
      requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener('resize', () => {
      emojiBalls.forEach(ball => {
        ball.x = Math.min(ball.x, window.innerWidth - ball.size);
        ball.y = Math.min(ball.y, window.innerHeight - ball.size);
      });
    });
  </script>
</body>
</html>
